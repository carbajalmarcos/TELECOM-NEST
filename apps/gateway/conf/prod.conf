server {
        listen 8080;

    
        location /login {
            add_header Allow "POST, HEAD" always;
            if ( $request_method !~ ^(POST|HEAD)$ ) {
	          return 405;
            }          
            proxy_pass          http://endpoints-utils:3010/login;
            proxy_set_header    X-Forwarded-For $remote_addr;
        }

        location /send {
            add_header Allow "POST, HEAD" always;
            if ( $request_method !~ ^(POST|HEAD)$ ) {
	          return 405;
            }
            proxy_pass          http://publisher:3000/send;
            proxy_set_header    X-Forwarded-For $remote_addr;
        }

        location /receive {
            add_header Allow "POST, HEAD" always;
            if ( $request_method !~ ^(POST|HEAD)$ ) {
	          return 405;
            }
            proxy_pass          http://receive-sms:3001/receive;
            proxy_set_header    X-Forwarded-For $remote_addr;
        }

        location /message/track-id/ {
            add_header Allow "GET, HEAD" always;
            if ( $request_method !~ ^(GET|HEAD)$ ) {
	          return 405;
            }          
            proxy_pass          http://endpoints-utils:3010/message/track-id/$args;
            proxy_set_header    X-Forwarded-For $remote_addr;
        }

        location /message/ {
            add_header Allow "GET, HEAD" always;
            if ( $request_method !~ ^(GET|HEAD)$ ) {
	          return 405;
            }          
            proxy_pass          http://endpoints-utils:3010/message/$args;
            proxy_set_header    X-Forwarded-For $remote_addr;
        }

}
